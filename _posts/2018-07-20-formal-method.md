---
title:  "沉迷「形式化方法」"
date:   2018-07-20
tags: ["随笔", "形式化方法"]
abstract: >-
    我是怎么沉沦到「形式化方法」中的。
---

# 2018年7月17日

2018年7月17日，神奇的一天！上午去交了水费，回来已经10点多了。原本计划这天要读若干关于 Single-shot Multibox Dection 的博客文章，好理解这个算法的实现过程。可近来已经高强度学习「深度学习」的知识，大脑有些疲惫。不知怎的，忽然就想起来在 g9 老大的博客看看到的关于形式化开发的事情来，然后又想到王垠对形式化方法的一些评论。索性换一下脑筋，就去搜了一下。

初始看到的信息一如既往的无聊，直到在知乎上看到这样一个文章：[C专家编程中对形式化方法的评论现在还是这样的么？](https://www.zhihu.com/question/63599847/answer/210992337)，虽然题主说的那段我已经没什么印象，而 《C Expert》的作者也不过就是说形式化方法没用云云。不过题主提到了裘宗燕的文章：[形式化方法 ｜形式化方法对软件开发的挑战：历史与发展](https://mp.weixin.qq.com/s?__biz=MzI5MjEyNjI5NQ==&mid=2650112204&idx=1&sn=75ca08855d424b1344eafab2ae453762&chksm=f4070bf4c37082e24a8864d224967536dd952267cc122a201c442ec1c8a55013aaf95c7095a1&mpshare=1&scene=1&srcid=0808Q2Ix24T10nDErSMDn6vB&pass_ticket=it4i3GHXmDHfTHlVq%2Fhsp2Rm7ab0udS%2BI%2BxwzHDYEMenOMUQDam7S34PJ1Vl560%2B#rd)，就是这篇文章，搞得我一连两三天都没有心情学习深度学习，一门心思的研究起了形式化方法。

这篇文章当然是讲了一些形式化方法的过去和将来，但里面提到了一个神奇的方法叫：B 方法。据说这个方法已经成功的应用在了现实世界的大规模关键性软件的开发之中了。B 方法的早期应用案例是开发了巴黎地铁的信号系统和一些控制系统，包括巴黎地铁14号线的自动驾驶系统等。另外好像世界上很多轨道交通的控制系统都是由这个方法开发的。这一下就引起了我的好奇心。继续深入探索 B 方法，发现这是一个以数据证明为基础的软件设计工具。其主要的功能就是把软件的需求用规范化的语言进行描述，然后通过数学证明的方式，证明软件与需求是想符合的。最后通过不断对需求进行细化，达到可编码的程序，可以使用代码生成器，生成 C 或者 Ada 的代码。

回想之前我写的程序，每次在完成基本的软件架构的设计之后，总会有这样或者那样的疏漏，就算引入了单元测试，也不能排除所有可能引起问题的点。而我一直苦于没有一种方法来解决这个问题。这一天，我认识了 B 方法，似乎了发现了一盏明灯。于是，我一刻不停地收集着关于 B 方法的各种信息。在 Wiki 中，我发现了 B 方法的演进版  Event-B。然后在 YouTube 上找到了一个微软研究院提供的 Event-B 方法的小教程。看这个教程一直看到凌晨 2 点。

Event-B 并不是这一天唯一的收获，在知乎上还看到别一个帖子，说到了形式化方法的一个新近的成果：CompCert，这是一个使用形式化方法开发的 C 语言的编译器。它的特点就是：确保了编译并优化之后的代码与原代码的逻辑是一致的。而这个项目好像是使用 Coq 开发的。

之前就已经听过 Coq 的大名，一直以为是另一种编程语言，今天了解了一下，才知道是一个 proof assistant。当然现在我对 proof assistant是什么东西还不是很懂。大概看了一些例子，也看不懂。只是又想起了另一个早就知道，但又不知道怎么用的主席：F*。F* 是一种以程序验证为目标的语言。也就是说这个主席虽然和 F# 一样可以用来写程序，但它的主要目标并不是写一个可以执行的程序，而是类似 Coq 用来证明代码与要实现的目标是一致的。于是又看了一下 F* 的 tutorial。我的天，这那儿是 tutorial，比正经的学习手册也差不多。完全看得昏昏欲睡。

# 2018年7月18日

本来想继续研究深度学习的，结果昨天不出意料的失眠了。昨天因为看了大量的 Event-B 的资料，然后又很幸运的从一个朋友那那里得到了《Modeling with Event-B》这本书的英文版。同时，看 YouTube 上的 lecture，感觉 Event-B 方法，如果不是一些证明太难的话。于是萌生了使用这种方法贯穿以后我的所有开发了设计的工作的想法。

**NOTE** 就在刚才，忽然有了一个脑洞：如果使用 Event-B 建模，生成目标代码，然后使用 pix2code + 强化学习生成前端代码，似乎是一个完整的软件开发解决方案了。

这一整天，就是在各种胡思乱想中度过的，又看了很多的关于形式化方法的视频，一些博客文章，下载了一些文档。

# 2018年7月19日

对形式化方法的热情开始降温，不过并不是那种准备放弃的降温。这一天，我加入了一个 Event-B 的研究学习群，虽然这种群实际上并没有什么卵用。又安装了 Rodin，一个进行 Event-B 开发的工具。然后这一天就开始回到深度学习的工作中去了。

# 后记

经过了三天的折腾，对 Event-B 似乎深信不疑。不过，因为涉及到数学，这个并不容易学会。所以准备花一点埋单研究一下：先把《Modeling with Event-B》这书学习一遍。一边阅读，一边照做，一边做练习。等我完成了这本书，就可以使用 NTP（Network Time Protocol）来开刀，把 RFC 形式化，然后开发一个 NTPD 出来。当然更长远的目标还是编译器和操作系统。不过，这段时间又可以安静下来了。
